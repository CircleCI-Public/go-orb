description: "Load cached Go build cache."
parameters:
  key:
    description: "User-configurable component for cache key. Useful for avoiding collisions in complex workflows."
    type: string
    default: ""
  use_branch:
    description: "Flag to support branch name in cache."
    type: boolean
    default: false

steps:
  - when:
      condition: << parameters.use_branch >>
      steps:
        - restore_cache:
            keys:
              - v1-<< parameters.key >>-go-build-{{ .Environment.CIRCLE_JOB }}-{{ arch }}-{{ checksum "go.sum" }}-{{ epoch | round "72h" }}
  - unless:
      condition: << parameters.use_branch >>
      steps:
        - restore_cache:
            keys:
              - v1-<< parameters.key >>-go-build-{{ .Environment.CIRCLE_JOB }}-{{ arch }}-{{ .Branch }}-{{ checksum "go.sum" }}-{{ epoch | round "72h" }}
